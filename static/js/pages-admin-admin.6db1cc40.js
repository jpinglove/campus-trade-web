(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-admin-admin"],{"14eb":function(n,t,e){var a=e("b25e");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);var o=e("967d").default;o("2fce8fdd",a,!0,{sourceMap:!1,shadowMode:!1})},"28f1":function(n,t,e){"use strict";var a=e("14eb"),o=e.n(a);o.a},6021:function(n,t,e){"use strict";e("6a54");var a=e("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.downloadFile=function(n,t){uni.showLoading({title:"正在生成文件..."}),uni.request({url:o.BASE_URL+n,header:{Authorization:"Bearer ".concat(i.default.state.token)},responseType:"arraybuffer",success:function(n){var e=n.header["Content-Type"]||n.header["content-type"];if(e&&e.includes("application/json")){console.log("whwhwhw"),console.log(n.data);var a=function(n){for(var t="",e=new Uint8Array(n),a=e.byteLength,o=0;o<a;o++)t+=String.fromCharCode(e[o]);try{return decodeURIComponent(escape(t))}catch(i){return console.error("Failed to decode URI component",i),t}}(n.data);console.log(a);var o=JSON.parse(a);console.log(JSON.stringify(o)),"No data to export."===o.message?uni.showToast({title:"没有可导出的数据",icon:"none"}):uni.showToast({title:"发生未知错误",icon:"none"})}else if(200===n.statusCode){var i=new Blob([n.data]),c=URL.createObjectURL(i),r=document.createElement("a");r.href=c,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(c)}else uni.showToast({title:"导出失败",icon:"none"})},fail:function(n){uni.showToast({title:"网络错误，导出失败",icon:"none"})},complete:function(){uni.hideLoading()}})},e("4db2"),e("bf0f"),e("c976"),e("4d8f"),e("7b97"),e("668a"),e("c5b7"),e("8ff5"),e("2378"),e("641a"),e("64e0"),e("cce3"),e("efba"),e("d009"),e("bd7d"),e("7edd"),e("d798"),e("f547"),e("5e54"),e("b60a"),e("8c18"),e("12973"),e("f991"),e("198e"),e("8557"),e("63b1"),e("1954"),e("1cf1"),e("4626"),e("5ac7"),e("d4b5"),e("18f7"),e("de6c"),e("dc89"),e("2425");var o=e("9064"),i=a(e("9707"))},6413:function(n,t,e){"use strict";e("6a54");var a=e("3639").default,o=e("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,e("fd3c"),e("c223"),e("f7a5");var i=o(e("2634")),c=o(e("2fdc")),r=a(e("9064")),s=e("6021"),d={data:function(){return{dailyPostsData:{}}},onLoad:function(){this.fetchDailyPostsStats()},onReady:function(){},methods:{fetchDailyPostsStats:function(){var n=this;return(0,c.default)((0,i.default)().mark((function t(){var e,a;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,r.default)({url:"/admin/stats/daily-posts"});case 3:e=t.sent,a={categories:e.map((function(n){return n._id})),series:[{name:"发布量",data:e.map((function(n){return n.count}))}]},n.dailyPostsData=a,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error("Failed to fetch daily posts stats:",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},exportData:function(n,t){(0,s.downloadFile)(n,t)},importProducts:function(){var n=this;uni.chooseFile({count:1,extension:[".csv"],success:function(t){uni.showLoading({title:"正在上传并导入..."}),uni.uploadFile({url:r.BASE_URL+"/admin/import/products",filePath:t.tempFilePaths[0],name:"file",header:{Authorization:"Bearer ".concat(n.$store.state.token)},success:function(n){var t=JSON.parse(n.data);console.log("导入结果:",t.message);var e="成功: ".concat(t.successCount,"条\n失败: ").concat(t.failureCount,"条");console.log("导入结果:",t.errors),t.errors&&t.errors.length>0&&(e+="\n\n部分错误日志:\n"+t.errors.slice(0,5).join("\n")),uni.showModal({title:"导入完成",content:e,showCancel:!1})},fail:function(){uni.showToast({title:"导入失败",icon:"none"})},complete:function(){uni.hideLoading()}})}})}}};t.default=d},a0c5:function(n,t,e){"use strict";e.r(t);var a=e("c421"),o=e("fd03");for(var i in o)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return o[n]}))}(i);e("28f1");var c=e("828b"),r=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,"2fc82e96",null,!1,a["a"],void 0);t["default"]=r.exports},b25e:function(n,t,e){var a=e("c86c");t=a(!1),t.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* 管理员页面样式 */.admin-section[data-v-2fc82e96]{margin-top:%?40?%;background:#fff;padding:%?20?%;border-radius:%?10?%}.section-title[data-v-2fc82e96]{ /* ... */}.button-grid[data-v-2fc82e96]{display:grid;grid-template-columns:1fr 1fr;gap:%?20?%;margin-top:%?20?%}.container[data-v-2fc82e96]{padding:%?20?%}.chart-card[data-v-2fc82e96]{background-color:#fff;border-radius:%?10?%;padding:%?20?%;margin-bottom:%?30?%}.card-title[data-v-2fc82e96]{font-size:%?32?%;font-weight:700;display:block;margin-bottom:%?20?%}",""]),n.exports=t},c421:function(n,t,e){"use strict";e.d(t,"b",(function(){return a})),e.d(t,"c",(function(){return o})),e.d(t,"a",(function(){}));var a=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("v-uni-view",{staticClass:"container"},[e("v-uni-view",{staticClass:"chart-card"},[e("v-uni-text",{staticClass:"card-title"},[n._v("每日发布量趋势")]),e("v-uni-view",{staticStyle:{width:"100%",height:"500rpx"}},[n.dailyPostsData.categories?e("ucharts",{attrs:{type:"line",chartData:n.dailyPostsData}}):n._e()],1)],1),e("v-uni-view",{staticClass:"admin-section"},[e("v-uni-text",{staticClass:"section-title"},[n._v("数据导出")]),e("v-uni-view",{staticClass:"button-grid"},[e("v-uni-button",{on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.exportData("/admin/export/users","all_users.csv")}}},[n._v("导出用户")]),e("v-uni-button",{on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.exportData("/admin/export/products","all_products.csv")}}},[n._v("导出商品")]),e("v-uni-button",{on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.exportData("/admin/export/orders","all_orders.csv")}}},[n._v("导出订单")])],1)],1),e("v-uni-view",{staticClass:"admin-section"},[e("v-uni-text",{staticClass:"section-title"},[n._v("数据导入")]),e("v-uni-button",{on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.importProducts.apply(void 0,arguments)}}},[n._v("导入商品 (CSV)")])],1)],1)},o=[]},fd03:function(n,t,e){"use strict";e.r(t);var a=e("6413"),o=e.n(a);for(var i in a)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return a[n]}))}(i);t["default"]=o.a}}]);