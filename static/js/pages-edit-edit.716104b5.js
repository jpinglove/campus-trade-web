(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-edit-edit"],{"0bff":function(n,t,a){"use strict";a.r(t);var e=a("24de"),i=a.n(e);for(var o in e)["default"].indexOf(o)<0&&function(n){a.d(t,n,(function(){return e[n]}))}(o);t["default"]=i.a},"24de":function(n,t,a){"use strict";a("6a54");var e=a("3639").default,i=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("01a2"),a("e39c"),a("c223"),a("bf0f");var o=i(a("2634")),r=i(a("2fdc")),c=i(a("9b1b")),s=e(a("9064")),u=a("8f59"),l={data:function(){return{productId:null,loading:!0,saving:!1,formData:{title:"",description:"",price:null,category:""},imageTempPath:"",imagePreview:""}},onLoad:function(n){if(!n.id)return uni.showToast({title:"无效的商品",icon:"none"}),void uni.navigateBack();this.productId=n.id,this.fetchProductData()},methods:(0,c.default)((0,c.default)({},(0,u.mapMutations)(["SET_HOME_NEEDS_REFRESH"])),{},{fetchProductData:function(){var n=this;return(0,r.default)((0,o.default)().mark((function t(){var a;return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,s.default)({url:"/products/".concat(n.productId)});case 3:a=t.sent,n.formData.title=a.title,n.formData.description=a.description,n.formData.price=a.price,n.formData.category=a.category,n.imagePreview="".concat(s.BASE_URL,"/products/").concat(n.productId,"/image?t=").concat((new Date).getTime()),n.loading=!1,t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),uni.showToast({title:"加载商品信息失败",icon:"none"});case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},chooseImage:function(){var n=this;uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){n.imageTempPath=t.tempFilePaths[0],n.imagePreview=t.tempFilePaths[0]}})},handleCancel:function(){uni.navigateBack()},handleSave:function(){var n=this;this.saving=!0,this.imageTempPath?uni.uploadFile({url:"".concat(s.BASE_URL,"/products/").concat(this.productId),filePath:this.imageTempPath,name:"imageFile",method:"PUT",header:{Authorization:"Bearer ".concat(this.$store.state.token)},formData:this.formData,success:function(t){n.onSaveSuccess()},fail:function(t){n.onSaveFail(t)},complete:function(){n.saving=!1}}):(0,s.default)({url:"/products/".concat(this.productId),method:"PUT",data:this.formData}).then((function(t){n.onSaveSuccess()})).catch((function(t){n.onSaveFail(t)})).finally((function(){n.saving=!1}))},onSaveSuccess:function(){uni.showToast({title:"保存成功"}),this.SET_HOME_NEEDS_REFRESH(!0),setTimeout((function(){uni.navigateBack()}),1500)},onSaveFail:function(n){console.error(n),uni.showToast({title:"保存失败，请重试",icon:"none"})}})};t.default=l},"2a9b":function(n,t,a){"use strict";a.r(t);var e=a("e7d5"),i=a("0bff");for(var o in i)["default"].indexOf(o)<0&&function(n){a.d(t,n,(function(){return i[n]}))}(o);a("b416");var r=a("828b"),c=Object(r["a"])(i["default"],e["b"],e["c"],!1,null,"620b5434",null,!1,e["a"],void 0);t["default"]=c.exports},4695:function(n,t,a){var e=a("c86c");t=e(!1),t.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* 表单样式 */.container[data-v-620b5434]{padding:%?20?%}.form-card[data-v-620b5434]{background:#fff;padding:%?30?%;border-radius:%?10?%}.form-group[data-v-620b5434]{margin-bottom:%?30?%}.form-label[data-v-620b5434]{font-size:%?30?%;color:#007aff; /* 醒目的蓝色 */margin-bottom:%?10?%;display:block}.form-input[data-v-620b5434]{border:1px solid #eee;padding:%?15?%;border-radius:%?5?%}.form-textarea-description[data-v-620b5434]{border:1px solid #eee;padding:%?15?%;width:auto; /* uni-app 会自动处理宽度 */height:%?200?%;border-radius:%?5?%}\n/* 图片上传区域样式 */.image-uploader[data-v-620b5434]{margin-top:%?10?%}.upload-btn[data-v-620b5434]{width:%?200?%;height:%?200?%;position:relative;border:2px dashed #ccc;border-radius:%?10?%;overflow:hidden /* 确保子元素不超出圆角 */}.image-preview[data-v-620b5434]{width:100%;height:100%}.re-upload-text[data-v-620b5434]{position:absolute;bottom:0;width:100%;background-color:rgba(0,0,0,.4);color:#fff;text-align:center;padding:%?5?% 0;font-size:%?24?%}\n/* 按钮组样式 */.button-group[data-v-620b5434]{display:flex;margin-top:%?40?%}.cancel-btn[data-v-620b5434]{flex:1;margin-right:%?10?%;background-color:#f0f0f0}.submit-btn[data-v-620b5434]{flex:1;margin-left:%?10?%;background-color:#007aff;color:#fff}",""]),n.exports=t},"7e47":function(n,t,a){var e=a("4695");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var i=a("967d").default;i("483da2c9",e,!0,{sourceMap:!1,shadowMode:!1})},b416:function(n,t,a){"use strict";var e=a("7e47"),i=a.n(e);i.a},e7d5:function(n,t,a){"use strict";a.d(t,"b",(function(){return e})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){}));var e=function(){var n=this,t=n.$createElement,a=n._self._c||t;return n.loading?n._e():a("v-uni-view",{staticClass:"container"},[a("v-uni-view",{staticClass:"form-card"},[a("v-uni-view",{staticClass:"form-group"},[a("v-uni-text",{staticClass:"form-label"},[n._v("商品名称")]),a("v-uni-input",{staticClass:"form-input",attrs:{placeholder:"请输入商品标题"},model:{value:n.formData.title,callback:function(t){n.$set(n.formData,"title",t)},expression:"formData.title"}})],1),a("v-uni-view",{staticClass:"form-group"},[a("v-uni-text",{staticClass:"form-label"},[n._v("商品描述")]),a("v-uni-textarea",{staticClass:"form-textarea-description",attrs:{placeholder:"请输入商品描述..."},model:{value:n.formData.description,callback:function(t){n.$set(n.formData,"description",t)},expression:"formData.description"}})],1),a("v-uni-view",{staticClass:"form-group"},[a("v-uni-text",{staticClass:"form-label"},[n._v("价格")]),a("v-uni-input",{staticClass:"form-input",attrs:{type:"number",placeholder:"请输入价格"},model:{value:n.formData.price,callback:function(t){n.$set(n.formData,"price",t)},expression:"formData.price"}})],1),a("v-uni-view",{staticClass:"form-group"},[a("v-uni-text",{staticClass:"form-label"},[n._v("分类")]),a("v-uni-input",{staticClass:"form-input",attrs:{placeholder:"如: 图书、电子产品"},model:{value:n.formData.category,callback:function(t){n.$set(n.formData,"category",t)},expression:"formData.category"}})],1),a("v-uni-view",{staticClass:"form-group"},[a("v-uni-text",{staticClass:"form-label"},[n._v("商品图片")]),a("v-uni-view",{staticClass:"image-uploader"},[a("v-uni-view",{staticClass:"upload-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.chooseImage.apply(void 0,arguments)}}},[a("v-uni-image",{staticClass:"image-preview",attrs:{src:n.imagePreview,mode:"aspectFill"}}),a("v-uni-view",{staticClass:"re-upload-text"},[n._v("点击更换图片")])],1)],1)],1),a("v-uni-view",{staticClass:"button-group"},[a("v-uni-button",{staticClass:"cancel-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.handleCancel.apply(void 0,arguments)}}},[n._v("取消")]),a("v-uni-button",{staticClass:"submit-btn",attrs:{disabled:n.saving},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.handleSave.apply(void 0,arguments)}}},[n._v(n._s(n.saving?"保存中...":"保存"))])],1)],1)],1)},i=[]}}]);