(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{"00ae":function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return a})),e.d(n,"a",(function(){}));var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",{staticClass:"content"},[e("v-uni-view",{staticClass:"search-bar-container"},[e("v-uni-input",{staticClass:"search-bar",attrs:{placeholder:"搜索商品标题"},on:{confirm:function(n){arguments[0]=n=t.$handleEvent(n),t.onSearch.apply(void 0,arguments)}},model:{value:t.filters.search,callback:function(n){t.$set(t.filters,"search",n)},expression:"filters.search"}})],1),e("v-uni-view",{staticClass:"filter-bar"},[e("v-uni-picker",{staticClass:"sort-picker",attrs:{value:t.sortIndex,range:t.sortOptions,"range-key":"text"},on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.onSortChange.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"picker-content"},[e("v-uni-text",[t._v(t._s(t.currentSortText))]),e("v-uni-text",{staticClass:"arrow-down"},[t._v("▼")])],1)],1),e("v-uni-view",{staticClass:"filter-btn",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.openFilterDrawer.apply(void 0,arguments)}}},[e("v-uni-image",{staticClass:"filter-icon",attrs:{src:"/static/filter.png"}}),e("v-uni-text",[t._v("筛选")])],1)],1),t.loading?e("v-uni-view",{staticClass:"empty-container"},[e("v-uni-text",[t._v("正在加载中...")])],1):t.products.length>0?e("product-list",{attrs:{products:t.products}}):e("v-uni-view",{staticClass:"empty-container"},[e("v-uni-image",{staticClass:"empty-image",attrs:{src:"/static/empty.png"}}),e("v-uni-text",{staticClass:"empty-text"},[t._v("市场空空如也，快来发布你的第一件商品吧！")])],1),e("uni-drawer",{ref:"filterDrawer",attrs:{mode:"right",width:320}},[e("v-uni-view",{staticClass:"filter-drawer-content"},[e("v-uni-text",{staticClass:"drawer-title"},[t._v("筛选条件")]),e("v-uni-view",{staticClass:"form-group"},[e("v-uni-text",{staticClass:"form-label"},[t._v("校区")]),e("v-uni-input",{staticClass:"form-input",attrs:{placeholder:"如: 主校区, 南校区"},model:{value:t.tempFilters.campus,callback:function(n){t.$set(t.tempFilters,"campus",n)},expression:"tempFilters.campus"}})],1),e("v-uni-view",{staticClass:"form-group"},[e("v-uni-text",{staticClass:"form-label"},[t._v("新旧程度")]),e("v-uni-picker",{staticClass:"condition-picker",attrs:{value:t.conditionIndex,range:t.conditionOptions},on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.onConditionChange.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"form-input picker-input"},[t._v(t._s(t.tempFilters.condition||"请选择"))])],1)],1),e("v-uni-view",{staticClass:"form-group"},[e("v-uni-text",{staticClass:"form-label"},[t._v("价格区间")]),e("v-uni-view",{staticClass:"price-range"},[e("v-uni-input",{staticClass:"form-input",attrs:{type:"number",placeholder:"最低价"},model:{value:t.tempFilters.priceMin,callback:function(n){t.$set(t.tempFilters,"priceMin",n)},expression:"tempFilters.priceMin"}}),e("v-uni-text",{staticClass:"price-separator"},[t._v("-")]),e("v-uni-input",{staticClass:"form-input",attrs:{type:"number",placeholder:"最高价"},model:{value:t.tempFilters.priceMax,callback:function(n){t.$set(t.tempFilters,"priceMax",n)},expression:"tempFilters.priceMax"}})],1)],1),e("v-uni-view",{staticClass:"drawer-buttons"},[e("v-uni-button",{staticClass:"drawer-btn reset-btn",attrs:{size:"mini"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.resetFilters.apply(void 0,arguments)}}},[t._v("重置")]),e("v-uni-button",{staticClass:"drawer-btn confirm-btn",attrs:{size:"mini"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.applyFilters.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1)],1)},a=[]},"1ae2":function(t,n,e){"use strict";e.r(n);var i=e("7e2b"),a=e("9716");for(var r in a)["default"].indexOf(r)<0&&function(t){e.d(n,t,(function(){return a[t]}))}(r);e("ada8");var s=e("828b"),o=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,"8371a55c",null,!1,i["a"],void 0);n["default"]=o.exports},2857:function(t,n,e){"use strict";var i=e("668b"),a=e.n(i);a.a},"41ba":function(t,n,e){var i=e("5ed1");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=e("967d").default;a("2706a79e",i,!0,{sourceMap:!1,shadowMode:!1})},"5ed1":function(t,n,e){var i=e("c86c");n=i(!1),n.push([t.i,".uni-drawer[data-v-8371a55c]{display:block;position:fixed;top:0;left:0;right:0;bottom:0;overflow:hidden;z-index:999}.uni-drawer__content[data-v-8371a55c]{display:block;position:absolute;top:0;width:220px;bottom:0;background-color:#fff;transition:-webkit-transform .3s ease;transition:transform .3s ease;transition:transform .3s ease,-webkit-transform .3s ease}.uni-drawer--left[data-v-8371a55c]{left:0;-webkit-transform:translateX(-100%);transform:translateX(-100%)}.uni-drawer--right[data-v-8371a55c]{right:0;-webkit-transform:translateX(100%);transform:translateX(100%)}.uni-drawer__content--visible[data-v-8371a55c]{-webkit-transform:translateX(0);transform:translateX(0)}.uni-drawer__mask[data-v-8371a55c]{display:block;opacity:0;position:absolute;top:0;left:0;bottom:0;right:0;background-color:rgba(0,0,0,.4);transition:opacity .3s}.uni-drawer__mask--visible[data-v-8371a55c]{display:block;opacity:1}",""]),t.exports=n},"668b":function(t,n,e){var i=e("bacf");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=e("967d").default;a("713ae516",i,!0,{sourceMap:!1,shadowMode:!1})},"72c1":function(t,n,e){"use strict";e("6a54"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,e("aa77"),e("bf0f"),e("dc8a"),e("4626"),e("5ac7");var i={name:"Keypress",props:{disable:{type:Boolean,default:!1}},mounted:function(){var t=this,n={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]};document.addEventListener("keyup",(function(e){if(!t.disable){var i=Object.keys(n).find((function(t){var i=e.key,a=n[t];return a===i||Array.isArray(a)&&a.includes(i)}));i&&setTimeout((function(){t.$emit(i,{})}),0)}}))},render:function(){}};n.default=i},"7e2b":function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return a})),e.d(n,"a",(function(){}));var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return t.visibleSync?e("v-uni-view",{staticClass:"uni-drawer",class:{"uni-drawer--visible":t.showDrawer},on:{touchmove:function(n){n.stopPropagation(),n.preventDefault(),arguments[0]=n=t.$handleEvent(n),t.clear.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"uni-drawer__mask",class:{"uni-drawer__mask--visible":t.showDrawer&&t.mask},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.close("mask")}}}),e("v-uni-view",{staticClass:"uni-drawer__content",class:{"uni-drawer--right":t.rightMode,"uni-drawer--left":!t.rightMode,"uni-drawer__content--visible":t.showDrawer},style:{width:t.drawerWidth+"px"}},[t._t("default")],2),e("keypress",{on:{esc:function(n){arguments[0]=n=t.$handleEvent(n),t.close("mask")}}})],1):t._e()},a=[]},"84fc":function(t,n,e){"use strict";e("6a54");var i=e("3639").default,a=e("f5bd").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,e("fd3c"),e("8f71"),e("bf0f"),e("dc8a"),e("c223"),e("64aa"),e("d4b5"),e("5ef2"),e("5c47"),e("af8f");var r=a(e("2634")),s=a(e("2fdc")),o=a(e("9b1b")),c=i(e("9064")),l=e("8f59"),d=a(e("1ae2")),u={components:{uniDrawer:d.default},data:function(){return{products:[],loading:!0,filters:{search:"",campus:"",condition:"",priceMin:"",priceMax:""},tempFilters:{},sortBy:"createdAt",sortOrder:"desc",sortIndex:0,sortOptions:[{value:{sortBy:"createdAt",sortOrder:"desc"},text:"最新发布"},{value:{sortBy:"price",sortOrder:"asc"},text:"价格最低"},{value:{sortBy:"price",sortOrder:"desc"},text:"价格最高"},{value:{sortBy:"viewCount",sortOrder:"desc"},text:"热度最高"}],conditionOptions:["全新","九成新","八成新","轻微瑕疵"],conditionIndex:-1}},computed:(0,o.default)((0,o.default)({},(0,l.mapState)(["homeNeedsRefresh"])),{},{currentSortText:function(){return this.sortOptions[this.sortIndex].text}}),onLoad:function(){this.fetchProducts()},onShow:function(){this.homeNeedsRefresh&&(console.log("Home page needs refresh! Fetching data..."),this.fetchProducts(),this.SET_HOME_NEEDS_REFRESH(!1))},onPullDownRefresh:function(){this.searchValue="",this.fetchProducts().then((function(){uni.stopPullDownRefresh()}))},methods:(0,o.default)((0,o.default)({},(0,l.mapMutations)(["SET_HOME_NEEDS_REFRESH"])),{},{fetchProducts:function(){var t=this;return(0,s.default)((0,r.default)().mark((function n(){var e,i,a;return(0,r.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.loading||uni.showNavigationBarLoading(),e=(0,o.default)((0,o.default)({},t.filters),{},{sortBy:t.sortBy,sortOrder:t.sortOrder}),console.log("Fetching products with params:",e),i=Object.keys(e).filter((function(t){return""!==e[t]&&null!==e[t]&&void 0!==e[t]})).map((function(t){return"".concat(t,"=").concat(encodeURIComponent(e[t]))})).join("&"),console.log("Fetching products with query:",i),n.prev=5,n.next=8,(0,c.default)({url:"/products?".concat(i)});case 8:a=n.sent,t.products=a,n.next=16;break;case 12:n.prev=12,n.t0=n["catch"](5),console.error(n.t0),t.products=[];case 16:return n.prev=16,t.loading=!1,uni.hideNavigationBarLoading(),n.finish(16);case 20:case"end":return n.stop()}}),n,null,[[5,12,16,20]])})))()},onSearch:function(t){this.fetchProducts()},onSortChange:function(t){var n=Number(t.detail.value),e=this.sortOptions[n];console.log(JSON.stringify(this.sortOptions[n])),console.log(JSON.stringify(e)),console.log(JSON.stringify(e["value"]));var i=e["value"];console.log("index =",t.detail.value),e&&(console.log(JSON.stringify(i)),this.sortIndex=n,this.sortBy=i.sortBy,this.sortOrder=i.sortOrder,console.log("sortIndex =",n),console.log("sortBy =",i.sortBy),console.log("sortOrder =",i.sortOrder),this.fetchProducts())},openFilterDrawer:function(){this.tempFilters=JSON.parse(JSON.stringify(this.filters)),this.conditionIndex=this.conditionOptions.indexOf(this.tempFilters.condition),this.$refs.filterDrawer.open()},onConditionChange:function(t){this.conditionIndex=t.detail.value,this.tempFilters.condition=this.conditionOptions[this.conditionIndex]},applyFilters:function(){this.filters=JSON.parse(JSON.stringify(this.tempFilters)),this.fetchProducts(),this.$refs.filterDrawer.close()},resetFilters:function(){this.tempFilters={search:this.filters.search,campus:"",condition:"",priceMin:"",priceMax:""},this.conditionIndex=-1}})};n.default=u},9716:function(t,n,e){"use strict";e.r(n);var i=e("ef38"),a=e.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){e.d(n,t,(function(){return i[t]}))}(r);n["default"]=a.a},"9a12":function(t,n,e){"use strict";e.r(n);var i=e("00ae"),a=e("9d7f");for(var r in a)["default"].indexOf(r)<0&&function(t){e.d(n,t,(function(){return a[t]}))}(r);e("2857");var s=e("828b"),o=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,"6760952e",null,!1,i["a"],void 0);n["default"]=o.exports},"9d7f":function(t,n,e){"use strict";e.r(n);var i=e("84fc"),a=e.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){e.d(n,t,(function(){return i[t]}))}(r);n["default"]=a.a},ada8:function(t,n,e){"use strict";var i=e("41ba"),a=e.n(i);a.a},bacf:function(t,n,e){var i=e("c86c");n=i(!1),n.push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* 简单样式 */.search-bar[data-v-6760952e]{border:1px solid #ccc;padding:%?10?%;margin:%?20?%;border-radius:%?30?%;background:#fff}.product-list[data-v-6760952e]{padding:0 %?20?%}.product-item[data-v-6760952e]{display:flex;padding:%?20?%;margin-bottom:%?20?%;background:#fff;border-radius:%?10?%}.product-image[data-v-6760952e]{width:%?150?%;height:%?150?%;margin-right:%?20?%;border-radius:%?10?%}.product-info[data-v-6760952e]{display:flex;flex-direction:column;justify-content:space-between}.product-price[data-v-6760952e]{color:red;margin-top:%?10?%;font-weight:700}\n/* 空状态样式 */.empty-container[data-v-6760952e]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-top:%?200?%;color:#999}.empty-image[data-v-6760952e]{width:%?200?%;height:%?200?%;margin-bottom:%?20?%}\n/* 排序筛选栏样式 */.filter-bar[data-v-6760952e]{display:flex;justify-content:space-around;align-items:center;padding:%?15?%;background:#fff;border-bottom:1px solid #f0f0f0;font-size:%?28?%}.sort-picker .picker-content[data-v-6760952e]{display:flex;align-items:center}.arrow-down[data-v-6760952e]{margin-left:%?8?%;font-size:%?20?%;color:#999}.filter-btn[data-v-6760952e]{display:flex;align-items:center;color:#007aff}.filter-icon[data-v-6760952e]{width:%?32?%;height:%?32?%;margin-right:%?8?%}\n/* 抽屉样式 */.filter-drawer-content[data-v-6760952e]{padding:%?30?%}.drawer-title[data-v-6760952e]{font-size:%?32?%;font-weight:700;margin-bottom:%?40?%;display:block}.form-group[data-v-6760952e]{margin-bottom:%?30?%}.form-label[data-v-6760952e]{font-size:%?28?%;color:#666;margin-bottom:%?10?%;display:block}.form-input[data-v-6760952e]{border:1px solid #eee;padding:%?15?%;border-radius:%?5?%;font-size:%?28?%}.price-range[data-v-6760952e]{display:flex;align-items:center}.price-separator[data-v-6760952e]{margin:0 %?15?%;color:#999}.picker-input[data-v-6760952e]{color:#333 /* 确保picker有正常的文字颜色 */}.drawer-buttons[data-v-6760952e]{display:flex;margin-top:%?50?%}.drawer-btn[data-v-6760952e]{flex:1}.reset-btn[data-v-6760952e]{margin-right:%?15?%}",""]),t.exports=n},ef38:function(t,n,e){"use strict";e("6a54");var i=e("f5bd").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,e("64aa");var a=i(e("72c1")),r={name:"UniDrawer",components:{keypress:a.default},emits:["change"],props:{mode:{type:String,default:""},mask:{type:Boolean,default:!0},maskClick:{type:Boolean,default:!0},width:{type:Number,default:220}},data:function(){return{visibleSync:!1,showDrawer:!1,rightMode:!1,watchTimer:null,drawerWidth:220}},created:function(){this.drawerWidth=this.width,this.rightMode="right"===this.mode},methods:{clear:function(){},close:function(t){("mask"!==t||this.maskClick)&&this.visibleSync&&this._change("showDrawer","visibleSync",!1)},open:function(){this.visibleSync||this._change("visibleSync","showDrawer",!0)},_change:function(t,n,e){var i=this;this[t]=e,this.watchTimer&&clearTimeout(this.watchTimer),this.watchTimer=setTimeout((function(){i[n]=e,i.$emit("change",e)}),e?50:300)}}};n.default=r}}]);