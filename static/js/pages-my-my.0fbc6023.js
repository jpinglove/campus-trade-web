(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-my-my"],{"4e03":function(t,e,n){"use strict";n("6a54");var i=n("3639").default,a=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("c223"),n("d4b5");var s=a(n("2634")),o=a(n("2fdc")),r=a(n("9b1b")),u=i(n("9064")),c=n("8f59"),l={data:function(){return{isLoginView:!0,loginForm:{studentId:"",password:""},registerForm:{studentId:"",nickname:"",password:""}}},computed:(0,r.default)((0,r.default)({},(0,c.mapState)(["token","userInfo"])),{},{isAdmin:function(){return this.userInfo&&!0===this.userInfo.isAdmin}}),methods:(0,r.default)((0,r.default)({},(0,c.mapMutations)(["LOGIN","LOGOUT"])),{},{goToList:function(t){uni.navigateTo({url:"/pages/".concat(t,"/").concat(t)})},goToAdminPage:function(){uni.navigateTo({url:"/pages/admin/admin"})},handleLogin:function(){var t=this;return(0,o.default)((0,s.default)().mark((function e(){var n;return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.default)({url:"/auth/login",method:"POST",data:t.loginForm});case 3:n=e.sent,console.log("-------------------------------------------"),console.log("[CLIENT DEBUG] Received response from server:"),console.log(JSON.stringify(n,null,2)),console.log("-------------------------------------------"),t.LOGIN({token:n.accessToken,userInfo:{id:n.id,studentId:n.studentId,nickname:n.nickname,isAdmin:n.isAdmin}}),uni.showToast({title:"登录成功"}),1==userInfo.isAdmin&&(uni.showToast({title:"管理员"}),console.log("管理员 isAdmin")),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](0),uni.showToast({title:"登录失败，请检查学号或密码",icon:"none"});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))()},handleRegister:function(){var t=this;return(0,o.default)((0,s.default)().mark((function e(){return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.default)({url:"/auth/register",method:"POST",data:t.registerForm});case 3:uni.showToast({title:"注册成功，请登录"}),t.isLoginView=!0,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),uni.showToast({title:"注册失败，学号可能已被使用",icon:"none"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},logout:function(){this.LOGOUT(),uni.showToast({title:"已退出登录"})}})};e.default=l},6495:function(t,e,n){"use strict";n.r(e);var i=n("7049"),a=n("7d34");for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);n("ed18");var o=n("828b"),r=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,"4e480626",null,!1,i["a"],void 0);e["default"]=r.exports},"69b0":function(t,e,n){var i=n("c86c");e=i(!1),e.push([t.i,".container[data-v-4e480626]{padding-bottom:%?40?%}.profile-card[data-v-4e480626], .form-card[data-v-4e480626]{background:#fff;padding:%?30?%;border-radius:%?10?%;text-align:center;position:relative}.welcome-text[data-v-4e480626]{font-size:%?36?%;display:block;margin-bottom:%?40?%}.logout-btn[data-v-4e480626]{background-color:#f44336;color:#fff;margin:%?40?% %?20?% 0}.form-input[data-v-4e480626]{border:1px solid #eee;padding:%?15?%;margin-bottom:%?20?%;text-align:left}.submit-btn[data-v-4e480626]{background-color:#007aff;color:#fff;margin-bottom:%?20?%}.switch-text[data-v-4e480626]{color:#007aff;font-size:%?28?%}.menu-list[data-v-4e480626]{margin:%?20?%;background:#fff;border-radius:%?10?%}.menu-item[data-v-4e480626]{display:flex;align-items:center;padding:%?25?%;border-bottom:1px solid #eee}.menu-item[data-v-4e480626]:last-child{border-bottom:none}.menu-icon[data-v-4e480626]{width:%?40?%;height:%?40?%;margin-right:%?20?%}.menu-text[data-v-4e480626]{flex:1}.arrow[data-v-4e480626]{color:#ccc}.admin-badge[data-v-4e480626]{position:absolute;top:%?20?%;right:%?20?%;background-color:#ffc107;color:#333;padding:%?5?% %?15?%;border-radius:%?20?%;font-size:%?24?%;font-weight:700}.admin-section[data-v-4e480626]{border:2px solid #ffc107}.admin-text[data-v-4e480626]{color:#007aff;font-weight:700}",""]),t.exports=e},7049:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"container"},[t.token?n("v-uni-view",[n("v-uni-view",{staticClass:"profile-card"},[n("v-uni-text",{staticClass:"welcome-text"},[t._v("欢迎, "+t._s(t.userInfo.nickname))]),t.isAdmin?n("v-uni-view",{staticClass:"admin-badge"},[n("v-uni-text",[t._v("管理员")])],1):t._e()],1),n("v-uni-view",{staticClass:"menu-list"},[n("v-uni-view",{staticClass:"menu-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goToList("publications")}}},[n("v-uni-image",{staticClass:"menu-icon",attrs:{src:"/static/publish_list.png"}}),n("v-uni-text",{staticClass:"menu-text"},[t._v("我的发布")]),n("v-uni-text",{staticClass:"arrow"},[t._v(">")])],1),n("v-uni-view",{staticClass:"menu-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goToList("favorites")}}},[n("v-uni-image",{staticClass:"menu-icon",attrs:{src:"/static/favorite.png"}}),n("v-uni-text",{staticClass:"menu-text"},[t._v("我的收藏")]),n("v-uni-text",{staticClass:"arrow"},[t._v(">")])],1),n("v-uni-view",{staticClass:"menu-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goToList("orders")}}},[n("v-uni-image",{staticClass:"menu-icon",attrs:{src:"/static/order.png"}}),n("v-uni-text",{staticClass:"menu-text"},[t._v("订单记录")]),n("v-uni-text",{staticClass:"arrow"},[t._v(">")])],1),n("v-uni-view",{staticClass:"menu-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goToList("view-history")}}},[n("v-uni-image",{staticClass:"menu-icon",attrs:{src:"/static/history.png"}}),n("v-uni-text",{staticClass:"menu-text"},[t._v("浏览记录")]),n("v-uni-text",{staticClass:"arrow"},[t._v(">")])],1)],1),t.isAdmin?n("v-uni-view",{staticClass:"menu-list"},[n("v-uni-view",{staticClass:"menu-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goToAdminPage.apply(void 0,arguments)}}},[n("v-uni-image",{staticClass:"menu-icon",attrs:{src:"/static/dashboard.png"}}),n("v-uni-text",{staticClass:"menu-text"},[t._v("后台管理")]),n("v-uni-text",{staticClass:"arrow"},[t._v(">")])],1)],1):t._e(),n("v-uni-button",{staticClass:"logout-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.logout.apply(void 0,arguments)}}},[t._v("退出登录")])],1):n("v-uni-view",{staticClass:"form-card"},[t.isLoginView?n("v-uni-view",[n("v-uni-input",{staticClass:"form-input",attrs:{placeholder:"学号"},model:{value:t.loginForm.studentId,callback:function(e){t.$set(t.loginForm,"studentId",e)},expression:"loginForm.studentId"}}),n("v-uni-input",{staticClass:"form-input",attrs:{type:"password",placeholder:"密码"},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}}),n("v-uni-button",{staticClass:"submit-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleLogin.apply(void 0,arguments)}}},[t._v("登录")]),n("v-uni-text",{staticClass:"switch-text",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.isLoginView=!1}}},[t._v("没有账号？去注册")])],1):n("v-uni-view",[n("v-uni-input",{staticClass:"form-input",attrs:{placeholder:"学号"},model:{value:t.registerForm.studentId,callback:function(e){t.$set(t.registerForm,"studentId",e)},expression:"registerForm.studentId"}}),n("v-uni-input",{staticClass:"form-input",attrs:{placeholder:"昵称"},model:{value:t.registerForm.nickname,callback:function(e){t.$set(t.registerForm,"nickname",e)},expression:"registerForm.nickname"}}),n("v-uni-input",{staticClass:"form-input",attrs:{type:"password",placeholder:"密码"},model:{value:t.registerForm.password,callback:function(e){t.$set(t.registerForm,"password",e)},expression:"registerForm.password"}}),n("v-uni-button",{staticClass:"submit-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleRegister.apply(void 0,arguments)}}},[t._v("注册")]),n("v-uni-text",{staticClass:"switch-text",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.isLoginView=!0}}},[t._v("已有账号？去登录")])],1)],1)],1)},a=[]},"7d34":function(t,e,n){"use strict";n.r(e);var i=n("4e03"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=a.a},"852b":function(t,e,n){var i=n("69b0");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("967d").default;a("5a3e2bba",i,!0,{sourceMap:!1,shadowMode:!1})},ed18:function(t,e,n){"use strict";var i=n("852b"),a=n.n(i);a.a}}]);