(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-publish-publish"],{"0b0f":function(n,t,r){var i=r("c86c");t=i(!1),t.push([n.i,"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* ... 其他样式保持不变 ... */.form-card[data-v-4d319372]{background:#fff;padding:%?30?%;border-radius:%?10?%}.form-input[data-v-4d319372]{border:1px solid #eee;padding:%?15?%;margin-bottom:%?20?%}.form-textarea-description[data-v-4d319372]{border:1px solid #eee;padding:%?15?%;margin-bottom:%?20?%;width:auto;height:%?200?%}.submit-btn[data-v-4d319372]{background-color:#007aff;color:#fff;margin-top:%?20?%}\r\n/* 图片上传样式 */.image-uploader[data-v-4d319372]{margin-bottom:%?20?%}.upload-btn[data-v-4d319372]{width:%?200?%;height:%?200?%;border:2px dashed #ccc;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#999}.plus-icon[data-v-4d319372]{font-size:%?60?%}.image-preview-wrapper[data-v-4d319372]{width:%?200?%;height:%?200?%}.image-preview[data-v-4d319372]{width:100%;height:100%}",""]),n.exports=t},"4c3e":function(n,t,r){"use strict";var i=r("c8ef"),a=r.n(i);a.a},"9b78":function(n,t,r){"use strict";r.r(t);var i=r("cf29"),a=r.n(i);for(var e in i)["default"].indexOf(e)<0&&function(n){r.d(t,n,(function(){return i[n]}))}(e);t["default"]=a.a},b47f:function(n,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){}));var i=function(){var n=this,t=n.$createElement,r=n._self._c||t;return r("v-uni-view",{staticClass:"container"},[r("v-uni-view",{staticClass:"form-card"},[r("v-uni-input",{staticClass:"form-input",attrs:{placeholder:"商品标题"},model:{value:n.formData.title,callback:function(t){n.$set(n.formData,"title",t)},expression:"formData.title"}}),r("v-uni-textarea",{staticClass:"form-textarea-description",attrs:{placeholder:"商品描述..."},model:{value:n.formData.description,callback:function(t){n.$set(n.formData,"description",t)},expression:"formData.description"}}),r("v-uni-input",{staticClass:"form-input",attrs:{type:"number",placeholder:"价格"},model:{value:n.formData.price,callback:function(t){n.$set(n.formData,"price",t)},expression:"formData.price"}}),r("v-uni-input",{staticClass:"form-input",attrs:{placeholder:"分类 (如图书、电子产品)"},model:{value:n.formData.category,callback:function(t){n.$set(n.formData,"category",t)},expression:"formData.category"}}),r("v-uni-view",{staticClass:"form-group"},[r("v-uni-text",{staticClass:"form-label"},[n._v("校区")]),r("v-uni-picker",{attrs:{value:n.campusIndex,range:n.campusOptions},on:{change:function(t){arguments[0]=t=n.$handleEvent(t),n.onCampusChange.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"form-input"},[n._v(n._s(n.campusOptions[n.campusIndex]))])],1)],1),r("v-uni-view",{staticClass:"form-group"},[r("v-uni-text",{staticClass:"form-label"},[n._v("新旧程度")]),r("v-uni-picker",{attrs:{value:n.conditionIndex,range:n.conditionOptions},on:{change:function(t){arguments[0]=t=n.$handleEvent(t),n.onConditionChange.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"form-input"},[n._v(n._s(n.conditionOptions[n.conditionIndex]))])],1)],1),r("v-uni-view",{staticClass:"image-uploader"},[n.imagePreview?r("v-uni-view",{staticClass:"image-preview-wrapper",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.chooseImage.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"image-preview",attrs:{src:n.imagePreview,mode:"aspectFill"}})],1):r("v-uni-view",{staticClass:"upload-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.chooseImage.apply(void 0,arguments)}}},[r("v-uni-text",{staticClass:"plus-icon"},[n._v("+")]),r("v-uni-text",[n._v("选择图片")])],1)],1),r("v-uni-button",{staticClass:"submit-btn",attrs:{disabled:n.uploading},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.submitForm.apply(void 0,arguments)}}},[n._v(n._s(n.uploading?"发布中...":"确认发布"))])],1)],1)},a=[]},c8ef:function(n,t,r){var i=r("0b0f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);var a=r("967d").default;a("66398813",i,!0,{sourceMap:!1,shadowMode:!1})},cf29:function(n,t,r){"use strict";r("6a54");var i=r("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(r("9b1b")),e=r("9064"),o=r("8f59"),s={data:function(){return{formData:{title:"",description:"",price:null,category:"",campus:"",condition:""},imageTempPath:"",imagePreview:"",uploading:!1,campusOptions:["主校区","南校区","北校区"],campusIndex:0,conditionOptions:["全新","九成新","八成新","轻微瑕疵"],conditionIndex:0}},onShow:function(){this.$store.state.token||(uni.showToast({title:"请先登录",icon:"none",duration:2e3}),setTimeout((function(){uni.switchTab({url:"/pages/my/my"})}),2e3))},methods:(0,a.default)((0,a.default)({},(0,o.mapMutations)(["SET_HOME_NEEDS_REFRESH"])),{},{onCampusChange:function(n){this.campusIndex=n.detail.value,this.formData.campus=this.campusOptions[this.campusIndex]},onConditionChange:function(n){this.conditionIndex=n.detail.value,this.formData.condition=this.conditionOptions[this.conditionIndex]},chooseImage:function(){var n=this;uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){n.imageTempPath=t.tempFilePaths[0],n.imagePreview=t.tempFilePaths[0]}})},submitForm:function(){for(var n=this,t=0,r=["title","description","price","category"];t<r.length;t++){var i=r[t];if(!this.formData[i])return void uni.showToast({title:"请填写所有商品信息",icon:"none"})}this.imageTempPath?(this.uploading=!0,this.formData.campus=this.campusOptions[this.campusIndex],this.formData.condition=this.conditionOptions[this.conditionIndex],uni.uploadFile({url:e.BASE_URL+"/products",filePath:this.imageTempPath,name:"imageFile",header:{Authorization:"Bearer ".concat(this.$store.state.token)},formData:this.formData,success:function(t){uni.showToast({title:"发布成功！"}),n.SET_HOME_NEEDS_REFRESH(!0),n.formData={title:"",description:"",price:null,category:""},n.imagePreview="",n.imageTempPath="",setTimeout((function(){uni.switchTab({url:"/pages/index/index"})}),1500)},fail:function(n){uni.showToast({title:"发布失败，请重试",icon:"none"}),console.error(n)},complete:function(){n.uploading=!1}})):uni.showToast({title:"请选择一张图片",icon:"none"})}})};t.default=s},dbc5:function(n,t,r){"use strict";r.r(t);var i=r("b47f"),a=r("9b78");for(var e in a)["default"].indexOf(e)<0&&function(n){r.d(t,n,(function(){return a[n]}))}(e);r("4c3e");var o=r("828b"),s=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,"4d319372",null,!1,i["a"],void 0);t["default"]=s.exports}}]);